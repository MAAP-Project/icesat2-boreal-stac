#!/usr/bin/env python
"""Update STAC metadata example files"""

import shutil
from pathlib import Path

from pystac import CatalogType

from stactools.icesat2_boreal.stac import Variable, create_collection, create_item

root = Path(__file__).parents[1]
examples = root / "examples"

if examples.exists():
    shutil.rmtree(examples)
    examples.mkdir()

for variable, cog_key, parquet_key in [
    (
        Variable.HT,
        "s3://maap-ops-workspace/aliz237/dps_output/run_boreal_biomass_map/v3.1.0/Ht_H30_2020/full_run/2025/08/20/14/01/56/204100/boreal_ht_2020_202508201755722400_0003543.tif",
        "s3://maap-ops-workspace/aliz237/dps_output/run_boreal_biomass_map/v3.1.0/Ht_H30_2020/full_run/2025/08/20/14/01/56/204100/boreal_ht_2020_202508201755722400_0003543_train.parquet",
    ),
    (
        Variable.AGB,
        "s3://maap-ops-workspace/aliz237/dps_output/run_boreal_biomass_map/v3.1.0/AGB_H30_2020/full_run/2025/08/19/09/59/01/262274/boreal_agb_2020_202508191755618683_0036023.tif",
        "s3://maap-ops-workspace/aliz237/dps_output/run_boreal_biomass_map/v3.1.0/AGB_H30_2020/full_run/2025/08/19/09/59/01/262274/boreal_agb_2020_202508191755618683_0036023_train.parquet",
    ),
]:
    variable_dir = examples / variable.value
    variable_dir.mkdir()

    collection = create_collection(variable)
    item = create_item(cog_key, parquet_key)
    collection.add_item(item)

    collection.normalize_hrefs(str(variable_dir))

    collection.save(CatalogType.SELF_CONTAINED)
